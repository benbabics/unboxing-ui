<treo-card class="flex-col w-100" [class.animate-pulse]="isLoading">
  <ng-container *ngIf="!isLoading; else contentHeaderLoading">
    <div class="flex mx-6 mt-6 mb-4">
      <div class="flex flex-col">
        <a 
          class="text-primary text-sm font-semibold"
          [routerLink]="[ '.' ]"
          [queryParams]="{ 'brand.id': project.brand.id }">
          {{ project.brand.name }}
        </a>
        <div class="text-xl font-semibold leading-tight mt-1">{{ project.title }}</div>
        <div class="text-secondary text-sm">33 minutes ago</div>
      </div>

      <button 
        class="ml-auto -mr-4"
        mat-icon-button
        [matMenuTriggerFor]="projectActionsMenu">
        <mat-icon svgIcon="more_vert"></mat-icon>
      </button>
      <mat-menu #projectActionsMenu="matMenu">
        <a
          mat-menu-item
          [routerLink]="[ '.', project.id, 'edit' ]">
          <span class="flex items-center">
            <span>Edit Project</span>
          </span>
        </a>
        <a
          mat-menu-item
          [routerLink]="[ '.', project.id ]">
          <span class="flex items-center">
            <span>View Project</span>
          </span>
        </a>
      </mat-menu>
    </div>
  </ng-container>

  <ng-container [ngSwitch]="assets.length">
    <ng-template [ngSwitchCase]="4"><ng-container *ngTemplateOutlet="gallery4"></ng-container></ng-template>
    <ng-template [ngSwitchCase]="3"><ng-container *ngTemplateOutlet="gallery3"></ng-container></ng-template>
    <ng-template [ngSwitchCase]="2"><ng-container *ngTemplateOutlet="gallery2"></ng-container></ng-template>
    <ng-template [ngSwitchCase]="1"><ng-container *ngTemplateOutlet="gallery1"></ng-container></ng-template>
    <ng-template [ngSwitchCase]="0"><ng-container *ngTemplateOutlet="galleryEmpty"></ng-container></ng-template>
    <ng-template ngSwitchDefault><ng-container *ngTemplateOutlet="galleryMultiple"></ng-container></ng-template>
  </ng-container>

  <div class="flex items-center mx-3 gt-xs:mx-5 mb-4">
    <button mat-button="" class="mat-focus-indicator px-3 mr-1 mat-button mat-button-base" tabindex="0">
      <span class="mat-button-wrapper">
        <mat-icon role="img" class="mat-icon notranslate icon-size-20 text-red mr-2 mat-icon-no-color" aria-hidden="true"><svg x="0" y="672" viewBox="0 0 24 24" fit="" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" focusable="false"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></svg></mat-icon>
        <span>Unlike</span>
      </span>
      <div matripple="" class="mat-ripple mat-button-ripple"></div>
    </button>
    <button mat-button="" class="mat-focus-indicator px-3 mr-1 mat-button mat-button-base" tabindex="0">
      <span class="mat-button-wrapper">
        <mat-icon role="img" class="mat-icon notranslate icon-size-20 mr-2 mat-icon-no-color" aria-hidden="true"><svg x="96" y="1200" viewBox="0 0 24 24" fit="" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" focusable="false"><path d="M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4V4c0-1.1-.9-2-2-2zm0 15.17L18.83 16H4V4h16v13.17z"></path><path opacity=".3" d="M4 4v12h14.83L20 17.17V4z"></path></svg></mat-icon>
        <span>Comment</span>
      </span>
      <div matripple="" class="mat-ripple mat-button-ripple"></div>
    </button>
    <button mat-button="" class="mat-focus-indicator px-3 mr-1 mat-button mat-button-base" tabindex="0">
      <span class="mat-button-wrapper">
        <mat-icon role="img" class="mat-icon notranslate icon-size-20 mr-2 mat-icon-no-color" aria-hidden="true"><svg x="96" y="1680" viewBox="0 0 24 24" fit="" height="100%" width="100%" preserveAspectRatio="xMidYMid meet" focusable="false"><path opacity=".3" d="M19 5a1 1 0 11-2 0 1 1 0 012 0zM7 12a1 1 0 11-2 0 1 1 0 012 0zM19 19.02a1 1 0 11-2 0 1 1 0 012 0z"></path><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92c0-1.61-1.31-2.92-2.92-2.92zM18 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM6 13c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm12 7.02c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"></path></svg></mat-icon>
        <span>Share</span>
      </span>
      <div matripple="" class="mat-ripple mat-button-ripple"></div>
    </button>
  </div>
</treo-card>


<ng-template #gallery4>
  <div class="flex mx-0 mb-4">
    <div class="flex flex-col pr-1">
      <div class="flex h-40 pb-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 0 }"></ng-container>
      </div>
      <div class="flex h-40 pt-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 1 }"></ng-container>
      </div>
    </div>
    
    <div class="flex flex-col pl-1">
      <div class="flex h-40 pb-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 2 }"></ng-container>
      </div>
      <div class="flex h-40 pt-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 3 }"></ng-container>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #gallery3>
  <div class="flex mx-0 mb-4">
    <div class="flex w-1/2 h-80 pr-1">
      <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 0 }"></ng-container>
    </div>
    
    <div class="flex w-1/2 flex-col pl-1">
      <div class="flex h-40 pb-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 1 }"></ng-container>
      </div>
      <div class="flex h-40 pt-1">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 2 }"></ng-container>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #gallery2>
  <div class="flex mx-0 mb-4">
    <div class="flex w-1/2 h-80 pr-1">
      <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 0 }"></ng-container>
    </div>
    
    <div class="flex w-1/2 h-80 pl-1">
      <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 1 }"></ng-container>
    </div>
  </div>
</ng-template>


<ng-template #gallery1>
  <div class="relative mx-0 mb-4">
    <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 0, classes: 'w-100 h-80' }"></ng-container>
  </div>
</ng-template>


<ng-template #galleryEmpty>
  <ng-container *ngIf="!isLoading; else galleryEmptyIsLoading">
    <div class="flex items-center justify-center mx-0 mb-4 h-80" style="background-color: #E2E8F0;">
      <mat-icon svgIcon="iconsmind:photos" class="opacity-75 icon-size-96"></mat-icon>
    </div>
  </ng-container>

  <ng-template #galleryEmptyIsLoading>
    <ng-container *ngTemplateOutlet="contentPhoto; context: { classes: 'w-100 h-80' }"></ng-container>
  </ng-template>
</ng-template>


<ng-template #galleryMultiple>
  <div class="flex flex-col mx-0 mb-4">
    <div class="flex pb-2">
      <div class="flex h-48 pr-2">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 0 }"></ng-container>
      </div>
      <div class="flex h-48">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 1 }"></ng-container>
      </div>
    </div>

    <div class="flex">
      <div class="flex w-1/3 h-30">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 2 }"></ng-container>
      </div>
      <div class="flex w-1/3 h-30 px-2">
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 3 }"></ng-container>
      </div>

      <div class="flex w-1/3 h-30 relative">
        <ng-container *ngIf="!isLoading && assetsCount > 5">
          <div class="absolute flex items-center justify-center inset-0 overflow-hidden">
            <span class="z-10 text-4xl text-white -ml-2">+{{ assetsCount - 5 }}</span>
            <span class="absolute w-full h-full bg-primary opacity-70"></span>
          </div>
        </ng-container>
        
        <ng-container *ngTemplateOutlet="contentPhoto; context: { $implicit: 4 }"></ng-container>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #contentHeaderLoading>
  <div class="mx-6 mt-6 mb-4">
    <div class="h-2 bg-gray-400 w-20"></div>
    <div class="mt-3 space-y-2">
      <div class="h-5 bg-gray-400 w-4/6"></div>
      <div class="h-3 bg-gray-400 w-30"></div>
    </div>
  </div>
</ng-template>


<ng-template #contentPhoto let-index let-classes="classes">
  <ng-container *ngIf="!isLoading; else greeking">
    <img [src]="assets[ index ].url" class="object-cover" [ngClass]="classes">
  </ng-container>

  <ng-template #greeking>
    <div class="w-50 bg-gray-400" [ngClass]="classes"></div>
  </ng-template>
</ng-template>
